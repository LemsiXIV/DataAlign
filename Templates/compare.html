
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataAlign</title>
    <link rel="stylesheet" href="{{url_for('static',filename='dist/output.css')}}">
</head>

<body>
                <!-- message error section start -->
     <div class="py-4 px-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
            <div class="p-4 mb-4 text-sm rounded-lg
                        {% if category == 'error' %} bg-red-100 text-red-800
                        {% elif category == 'success' %} bg-green-100 text-green-800
                        {% else %} bg-blue-100 text-blue-800
                        {% endif %}">
                {{ message }}
            </div>
            {% endfor %}
        {% endif %}
        {% endwith %}
    </div>
                <!-- message error section end -->


<section class="py-10 px-4">
    <!-- üîé ECARTS TROUV√âS SECTION -->
    {% if ecarts1 or ecarts2 %}
    <div class="mt-10 bg-white dark:bg-gray-800 shadow-md rounded-lg p-6">
        <h2 class="text-2xl font-bold text-gray-800 dark:text-white mb-6">√âcarts trouv√©s</h2>

        {% if ecarts1 %}
        <div class="flex-1 flex flex-col overflow-hidden shadow rounded-lg bg-white dark:bg-gray-800 mb-10">
            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                <h3 class="text-lg font-semibold text-red-600 dark:text-red-400">
                    üìÅ Donn√©es pr√©sentes seulement dans : <span class="font-bold">{{ file1_name }}</span>
                </h3>
                <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">
                    Lignes exclusives √† ce fichier.
                </p>
            </div>
            <div class="flex-1 overflow-auto max-h-[480px]">
                <table class="min-w-full text-sm text-left text-gray-700 dark:text-gray-300">
                    <thead class="text-xs uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                        <tr>
                            {% for key in ecarts1[0].keys() %}
                            <th class="px-6 py-3 border">{{ key }}</th>
                            {% endfor %}
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in ecarts1 %}
                        <tr class="bg-red-50 dark:bg-red-900 border-b dark:border-gray-700 hover:bg-red-100 dark:hover:bg-red-800">
                            {% for val in row.values() %}
                            <td class="px-6 py-4 border">{{ val }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% else %}
        <p class="text-gray-600 dark:text-gray-400 mb-8">‚úÖ Aucune donn√©e exclusive √† {{ file1_name }}.</p>
        {% endif %}

        {% if ecarts2 %}
        <div class="flex-1 flex flex-col overflow-hidden shadow rounded-lg bg-white dark:bg-gray-800">
            <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                <h3 class="text-lg font-semibold text-blue-600 dark:text-blue-400">
                    üìÅ Donn√©es pr√©sentes seulement dans : <span class="font-bold">{{ file2_name }}</span>
                </h3>
                <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">
                    Lignes exclusives √† ce fichier.
                </p>
            </div>
            <div class="flex-1 overflow-auto max-h-[480px]">
                <table class="min-w-full text-sm text-left text-gray-700 dark:text-gray-300">
                    <thead class="text-xs uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                        <tr>
                            {% for key in ecarts2[0].keys() %}
                            <th class="px-6 py-3 border">{{ key }}</th>
                            {% endfor %}
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in ecarts2 %}
                        <tr class="bg-blue-50 dark:bg-blue-900 border-b dark:border-gray-700 hover:bg-blue-100 dark:hover:bg-blue-800">
                            {% for val in row.values() %}
                            <td class="px-6 py-4 border">{{ val }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% else %}
        <p class="text-gray-600 dark:text-gray-400">‚úÖ Aucune donn√©e exclusive √† {{ file2_name }}.</p>
        {% endif %}
        
    </div>
    {% endif %}

    <div class="text-sm px-4 py-4 text-gray-500 dark:text-gray-400 mb-4">
    üîç {{ ecarts1|length }} ligne(s) uniques dans {{ file1_name }} | {{ ecarts2|length }} ligne(s) uniques dans {{ file2_name }}
    </div>
</section>

        <!-- pi chart start -->
    <section class="py-10 px-4">

        <div class="p-4 bg-gray-100 rounded-lg shadow mb-4">
            <h2 class="text-lg font-semibold mb-2">R√©sum√© de la comparaison</h2>
            <ul class="list-disc pl-5 text-sm">
                <li><strong>Total de lignes compar√©es :</strong> {{ total }}</li>
                <li><strong>Lignes dans {{ file1_name }} :</strong> {{ nb_df }}</li>
                <li><strong>Lignes dans {{ file2_name }} :</strong> {{ nb_df2 }}</li>
                <li class="text-red-500"><strong>√âcarts d√©tect√©s :</strong> {{ total_ecarts }} ({{ n1 }} dans {{ file1_name }}, {{ n2 }} dans {{ file2_name }})</li>
                <li class="text-green-600"><strong>Lignes communes :</strong> {{ n_common }}</li>
            </ul>
        </div>


        <h2 class="text-xl font-bold mt-8 mb-4">R√©partition des Donn√©es</h2>
        <canvas id="repartitionChart" width="400" height="400"></canvas>

        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script>
            const ctx = document.getElementById('repartitionChart').getContext('2d');
            new Chart(ctx, {
                type: 'pie',
                data: {
                labels: [
                    'Seulement dans {{ file1_name }}',
                    'Seulement dans {{ file2_name }}',
                    'Communs aux deux fichiers'
                ],
                datasets: [{
                    data: [{{ pct1 }}, {{ pct2 }}, {{ pct_both }}],
                    backgroundColor: ['#f87171', '#60a5fa', '#34d399'],  // rouge, bleu, vert
                    borderWidth: 1
                }]
                },
                options: {
                plugins: {
                    tooltip: {
                    callbacks: {
                        label: function(context) {
                        let label = context.label || '';
                        let value = context.parsed || 0;
                        return `${label}: ${value}%`;
                        }
                    }
                    }
                }
                }
            });
        </script>

        <div class="mb-4 space-y-1">
            <div><strong>Seulement dans {{ file1_name }} :</strong> {{ n1 }} lignes</div>
            <div><strong>Seulement dans {{ file2_name }} :</strong> {{ n2 }} lignes</div>
            <div><strong>Communs aux deux fichiers :</strong> {{ n_common }} lignes</div>
        </div>



    </section>

        <!-- pi chart end -->







        <!-- footer start section -->

                <footer class="bg-white rounded-lg shadow sm:flex sm:items-center sm:justify-between p-4 sm:p-6 xl:p-8 dark:bg-gray-800 antialiased">
                <p class="mb-4 text-sm text-center text-gray-500 dark:text-gray-400 sm:mb-0">
                    &copy; 2024-2025 <a href="https://sof-tunisie.sofrecom.fr/fr" class="hover:underline" target="_blank">Sofrecom.com</a>. All rights reserved.
                </p>
                <div class="flex justify-center items-center space-x-1">
                    <a href="#" data-tooltip-target="tooltip-facebook" class="inline-flex justify-center p-2 text-gray-500 rounded-lg cursor-pointer dark:text-gray-400 dark:hover:text-white hover:text-gray-900 hover:bg-gray-100 dark:hover:bg-gray-600">
                        <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 8 19">
                            <path fill-rule="evenodd" d="M6.135 3H8V0H6.135a4.147 4.147 0 0 0-4.142 4.142V6H0v3h2v9.938h3V9h2.021l.592-3H5V3.591A.6.6 0 0 1 5.592 3h.543Z" clip-rule="evenodd"/>
                        </svg>
                        <span class="sr-only">Facebook</span>
                    </a>
                    <div id="tooltip-facebook" role="tooltip" class="inline-block absolute invisible z-10 py-2 px-3 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-sm opacity-0 transition-opacity duration-300 tooltip dark:bg-gray-700">
                        Like us on Facebook
                        <div class="tooltip-arrow" data-popper-arrow></div>
                    </div>
                    <a href="#" data-tooltip-target="tooltip-twitter" class="inline-flex justify-center p-2 text-gray-500 rounded-lg cursor-pointer dark:text-gray-400 dark:hover:text-white hover:text-gray-900 hover:bg-gray-100 dark:hover:bg-gray-600">
                        <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                            <path fill="currentColor" d="M12.186 8.672 18.743.947h-2.927l-5.005 5.9-4.44-5.9H0l7.434 9.876-6.986 8.23h2.927l5.434-6.4 4.82 6.4H20L12.186 8.672Zm-2.267 2.671L8.544 9.515 3.2 2.42h2.2l4.312 5.719 1.375 1.828 5.731 7.613h-2.2l-4.699-6.237Z"/>
                        </svg>
                        <span class="sr-only">Twitter</span>
                    </a>
                    <div id="tooltip-twitter" role="tooltip" class="inline-block absolute invisible z-10 py-2 px-3 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-sm opacity-0 transition-opacity duration-300 tooltip dark:bg-gray-700">
                        Follow us on Twitter
                        <div class="tooltip-arrow" data-popper-arrow></div>
                    </div>
                    <a href="#" data-tooltip-target="tooltip-github" class="inline-flex justify-center p-2 text-gray-500 rounded-lg cursor-pointer dark:text-gray-400 dark:hover:text-white hover:text-gray-900 hover:bg-gray-100 dark:hover:bg-gray-600">
                        <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 .333A9.911 9.911 0 0 0 6.866 19.65c.5.092.678-.215.678-.477 0-.237-.01-1.017-.014-1.845-2.757.6-3.338-1.169-3.338-1.169a2.627 2.627 0 0 0-1.1-1.451c-.9-.615.07-.6.07-.6a2.084 2.084 0 0 1 1.518 1.021 2.11 2.11 0 0 0 2.884.823c.044-.503.268-.973.63-1.325-2.2-.25-4.516-1.1-4.516-4.9A3.832 3.832 0 0 1 4.7 7.068a3.56 3.56 0 0 1 .095-2.623s.832-.266 2.726 1.016a9.409 9.409 0 0 1 4.962 0c1.89-1.282 2.717-1.016 2.717-1.016.366.83.402 1.768.1 2.623a3.827 3.827 0 0 1 1.02 2.659c0 3.807-2.319 4.644-4.525 4.889a2.366 2.366 0 0 1 .673 1.834c0 1.326-.012 2.394-.012 2.72 0 .263.18.572.681.475A9.911 9.911 0 0 0 10 .333Z" clip-rule="evenodd"/>
                        </svg>
                        <span class="sr-only">Github</span>
                    </a>
                    <div id="tooltip-github" role="tooltip" class="inline-block absolute invisible z-10 py-2 px-3 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-sm opacity-0 transition-opacity duration-300 tooltip dark:bg-gray-700">
                        Star us on GitHub
                        <div class="tooltip-arrow" data-popper-arrow></div>
                    </div>
                    <a href="#" data-tooltip-target="tooltip-dribbble" class="inline-flex justify-center p-2 text-gray-500 rounded-lg cursor-pointer dark:text-gray-400 dark:hover:text-white hover:text-gray-900 hover:bg-gray-100 dark:hover:bg-gray-600">
                        <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 0a10 10 0 1 0 10 10A10.009 10.009 0 0 0 10 0Zm6.613 4.614a8.523 8.523 0 0 1 1.93 5.32 20.094 20.094 0 0 0-5.949-.274c-.059-.149-.122-.292-.184-.441a23.879 23.879 0 0 0-.566-1.239 11.41 11.41 0 0 0 4.769-3.366ZM8 1.707a8.821 8.821 0 0 1 2-.238 8.5 8.5 0 0 1 5.664 2.152 9.608 9.608 0 0 1-4.476 3.087A45.758 45.758 0 0 0 8 1.707ZM1.642 8.262a8.57 8.57 0 0 1 4.73-5.981A53.998 53.998 0 0 1 9.54 7.222a32.078 32.078 0 0 1-7.9 1.04h.002Zm2.01 7.46a8.51 8.51 0 0 1-2.2-5.707v-.262a31.64 31.64 0 0 0 8.777-1.219c.243.477.477.964.692 1.449-.114.032-.227.067-.336.1a13.569 13.569 0 0 0-6.942 5.636l.009.003ZM10 18.556a8.508 8.508 0 0 1-5.243-1.8 11.717 11.717 0 0 1 6.7-5.332.509.509 0 0 1 .055-.02 35.65 35.65 0 0 1 1.819 6.476 8.476 8.476 0 0 1-3.331.676Zm4.772-1.462A37.232 37.232 0 0 0 13.113 11a12.513 12.513 0 0 1 5.321.364 8.56 8.56 0 0 1-3.66 5.73h-.002Z" clip-rule="evenodd"/>
                        </svg>
                        <span class="sr-only">Dribbble</span>
                    </a>
                    <div id="tooltip-dribbble" role="tooltip" class="inline-block absolute invisible z-10 py-2 px-3 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-sm opacity-0 transition-opacity duration-300 tooltip dark:bg-gray-700">
                        Follow us on Dribbble
                        <div class="tooltip-arrow" data-popper-arrow></div>
                    </div>
                </div>
                </footer>

        <!-- footer end section -->


    <script src="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.js"></script>
</body>

</html>
